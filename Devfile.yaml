---
specVersion: 0.0.1
name: petclinic-dev-environment
projects:
  - name: petclinic
    source:
      type: git
      location: 'https://github.com/spring-projects/spring-petclinic.git'
components:
  - type: dockerimage
    alias: mvn-container
    image: maven:3.5.4-jdk-8
    command: ['/bin/sh', '-c']
    args: ['tail -f /dev/null']
    volumes:
      - name: maven-repo
        containerPath: /root/.m2
    endpoints:
      - name: spring-boot
        port: 8080
        attributes:
          path: /api
          protocol: http
          public: "true"
    env:
      - name: TERM
        value: xterm
    mountSources: true
    memoryLimit: 500M
  - type: kubernetes
    reference: https://raw.githubusercontent.com/redhat-developer/devfile/update-petclinic/petclinic.yaml
    selector:
      app.kubernetes.io/name: mysql
      app.kubernetes.io/component: database
      app.kubernetes.io/part-of: petclinic
  - type: cheEditor
    id: eclipse/che-theia/next
  - type: chePlugin
    id: redhat/java/0.43.0
commands:
  - name: build
    actions:
      - type: exec
        component: mvn-container
        command: mvn package
        workdir: /projects/spring-petclinic
